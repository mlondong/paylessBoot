<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head lang="en">
<title>Payless-Consumer</title>
<th:block th:include="layout/header2"></th:block>
<script type="text/javascript" 	src="http://code.jquery.com/jquery-1.10.2.js"> </script>
<script type="text/javascript" 	src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"> </script>
<link rel="stylesheet" 	href="http://code.jquery.com/ui/1.10.2/themes/smoothness/jquery-ui.css" />


<script type="text/javascript">
$(document).ready(function () {

	$("form").keypress(function(e) {
		  if (e.which == 13) {
		    return false;
		  }
	});



	 $("#description").autocomplete({
	        source: function(request, response) {
	         var description = $('#description').val();
			       if(description.length >=4 ) {
							$.ajax({
		                     url: "/consumer/getdescription",
		                     type: "GET",
		                     data: { description: $('#description').val() },
		                     dataType: "json",
		                     success: function(data){
														response($.map (data, function(v,i){
																alert(v);				
															return {
																//label: v.dni+' - '+v.firstName+' - '+v.lastName,
															    //value: v.dni
															   };			
														 }));
		                                            }
		                   }); 
			       }	                   
	        }   
	    });

	
	
	$('#btn_search').click(function() { 
	    	var product = $('#description').val();
	    	var flag=true;
	    	
	    	if(!isNaN(product)){
	    		flag=false;
				$('#span-error').after('<p>Please insert a correct value.</p>')
			}

	    	if(/^[a-zA-Z0-9]*$/.test(product) == false){
	    		flag=false;
			 	$('#span-error').after('<p>Please insert a correct value.</p>')
	    	}

	    	if(flag==true){
				$( "#formFindProduct" ).submit();
			}
	    	
	});

});




</script>
</head>


<body>
	<div id="div_search">
		<h2>Search Products</h2>
		<div th:if="${data!= null}">
			<h3 th:text="${data}"></h3>
			
		</div>
	
		<form action="/consumer/resulproducts"  method="get" id="formFindProduct"  >
			<div class="form-group">
				<table>
					<tbody>
						<tr>
							
							<td><label>By Name Product:</label></td>
							<td>
							<label for="description"></label> 
							<input type="text" id="description"  name="description" min="4" maxlength="8"/>
							<input type="hidden" id="dni"  name="dni" th:if="${data!=null}" th:value="${data.dni}">
							<input type="hidden" id="city"  name="city" th:if="${data!=null}" th:value="${data.address.city}">
							<input type="hidden" id="zone"  name="zone" th:if="${data!=null}" th:value="${data.address.zona}">
							
							
							
							</td>
							<td>
								<button type="button" id="btn_search" class="btn btn-primary">Search Product</button>
							</td>
						</tr>
						<tr>
							<td></td>
							<td><span id="data"> </span></td>
						</tr>
						
					</tbody>
				</table>
			</div>
		</form>
	</div>

	<div th:if="${notFilterProducts != null}">
		<h3 th:text="${notFilterProducts}"></h3>
	</div>


	<div th:if="${products != null}">
		<h3 th:text="${products}"></h3>
	</div>


</body>
</html>